<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin SKH</title>

<style>
body{
background:#000;
color:white;
font-family:Georgia,serif;
padding:40px;
}

h1{
color:gold;
}

table{
width:100%;
border-collapse:collapse;
margin-top:20px;
}

th,td{
border:1px solid #333;
padding:10px;
text-align:center;
}

th{
background:#111;
color:gold;
}

select{
padding:5px;
}

button{
padding:6px 12px;
border:none;
cursor:pointer;
border-radius:5px;
font-weight:bold;
}

.btn-hapus{
background:red;
color:white;
}

.btn-kembali{
background:gold;
color:black;
margin-top:30px;
padding:10px 20px;
}
</style>
</head>

<body>

<h1>Data Anggota</h1>

<table>
<thead>
<tr>
<th>No</th>
<th>Nama</th>
<th>No Anggota</th>
<th>Status</th>
<th>Aksi</th>
</tr>
</thead>
<tbody id="dataBody">
<tr><td colspan="5">Memuat...</td></tr>
</tbody>
</table>

<a href="index.html">
<button class="btn-kembali">Kembali ke Halaman Depan</button>
</a>

<script>

const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyPgjLBrypb4XYa8BnQs-mm7NtevJoDGCadCBhDvImoZUSo2AGHX0dND8ShvKA0njVg/exec";

async function loadData(){
const res = await fetch(WEB_APP_URL);
const data = await res.json();

let html="";
data.forEach((row,index)=>{

html+=`
<tr>
<td>${index+1}</td>
<td>${row["Nama Lengkap"]}</td>
<td>${row["No Anggota"]}</td>
<td>
<select onchange="updateStatus('${row["No Anggota"]}', this.value)">
<option ${row["Status"]==="Aktif"?"selected":""}>Aktif</option>
<option ${row["Status"]==="Tidak Aktif"?"selected":""}>Tidak Aktif</option>
</select>
</td>
<td>
<button class="btn-hapus" onclick="hapus('${row["No Anggota"]}')">Hapus</button>
</td>
</tr>
`;
});

document.getElementById("dataBody").innerHTML=html;
}

async function updateStatus(noAnggota,status){

await fetch(WEB_APP_URL,{
method:"POST",
body:JSON.stringify({
action:"updateStatus",
noAnggota:noAnggota,
status:status
})
});

loadData();
}

async function hapus(noAnggota){

if(!confirm("Yakin ingin menghapus anggota ini?")) return;

await fetch(WEB_APP_URL,{
method:"POST",
body:JSON.stringify({
action:"delete",
noAnggota:noAnggota
})
});

loadData();
}

loadData();

</script>

</body>
</html>
