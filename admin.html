<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin SKH</title>

<style>
body{margin:0;font-family:Arial;background:#111;color:#eee;padding:30px}
h1,h2{color:gold}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #333;padding:8px;text-align:center}
th{background:#222;color:gold}
button{padding:6px 12px;margin:4px;border:none;border-radius:4px;font-weight:bold;cursor:pointer}
.btn-gold{background:gold}
.btn-red{background:#b30000;color:white}
select{padding:5px}
.back{position:fixed;top:20px;right:30px;background:gold;padding:8px 15px;color:black;text-decoration:none;border-radius:5px;font-weight:bold}
</style>
</head>
<body>

<a href="index.html" class="back">Kembali</a>

<h1>ADMIN PANEL SKH</h1>

<h2>Data Anggota</h2>

<table>
<thead>
<tr>
<th>No</th>
<th>Nama</th>
<th>No Anggota</th>
<th>Status</th>
<th>Aksi</th>
</tr>
</thead>
<tbody id="tabelAnggota">
<tr><td colspan="5">Memuat...</td></tr>
</tbody>
</table>

<script>

const WEB_APP_URL="https://script.google.com/macros/s/AKfycbyPgjLBrypb4XYa8BnQs-mm7NtevJoDGCadCBhDvImoZUSo2AGHX0dND8ShvKA0njVg/exec";

/* ================= LOAD DATA ================= */

async function loadAnggota(){

    const res=await fetch(WEB_APP_URL);
    const data=await res.json();

    let html="";

    data.forEach((row,i)=>{

        html+=`
        <tr>
            <td>${i+1}</td>
            <td>${row["Nama Lengkap"]}</td>
            <td>${row["No Anggota"]}</td>
            <td>
                <select onchange="ubahStatus('${row["No Anggota"]}', this.value)">
                    <option value="Aktif" ${row["Status"]==="Aktif"?"selected":""}>Aktif</option>
                    <option value="Tidak Aktif" ${row["Status"]==="Tidak Aktif"?"selected":""}>Tidak Aktif</option>
                </select>
            </td>
            <td>
                <button class="btn-red" onclick="hapusAnggota('${row["No Anggota"]}')">Hapus</button>
            </td>
        </tr>
        `;
    });

    document.getElementById("tabelAnggota").innerHTML=html;
}


/* ================= UPDATE STATUS ================= */

async function ubahStatus(noAnggota,status){

    await fetch(WEB_APP_URL,{
        method:"POST",
        headers:{
            "Content-Type":"application/json"
        },
        body:JSON.stringify({
            action:"updateStatus",
            noAnggota:noAnggota,
            status:status
        })
    });

    loadAnggota();
}


/* ================= HAPUS ANGGOTA ================= */

async function hapusAnggota(noAnggota){

    if(!confirm("Yakin ingin menghapus anggota ini?")) return;

    await fetch(WEB_APP_URL,{
        method:"POST",
        headers:{
            "Content-Type":"application/json"
        },
        body:JSON.stringify({
            action:"delete",
            noAnggota:noAnggota
        })
    });

    loadAnggota();
}

loadAnggota();

</script>

</body>
</html>
