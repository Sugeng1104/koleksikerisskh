<!DOCTYPE html>
<html>
<head>
<title>Dashboard Admin</title>
<style>
body{
  margin:0;
  background:linear-gradient(to right,black,#001f1f);
  color:#00ffcc;
  font-family:Arial;
}
.sidebar{
  width:220px;
  height:100vh;
  background:black;
  position:fixed;
  padding:20px;
}
.sidebar button{
  width:100%;
  padding:10px;
  margin-top:10px;
  background:#00ffcc;
  border:none;
  cursor:pointer;
}
.content{
  margin-left:240px;
  padding:30px;
}
.card{
  background:#111;
  padding:20px;
  border-radius:10px;
  margin-bottom:20px;
}
input,select{
  padding:8px;
}
button.tambah{
  background:#00cc66;
  color:white;
  border:none;
  padding:8px 12px;
}
button.hapus{
  background:red;
  color:white;
  border:none;
  padding:6px 10px;
}
table{
  width:100%;
  margin-top:15px;
  border-collapse:collapse;
}
th,td{
  padding:10px;
  border-bottom:1px solid #333;
}
</style>
</head>
<body>

<div class="sidebar">
  <h2>ADMIN</h2>
  <p id="userInfo"></p>
  <p id="roleInfo"></p>

  <button onclick="window.location.href='index.html'">Halaman Depan</button>

  <button id="menuKelola" style="display:none;"
          onclick="window.location.href='kelola-akun.html'">
    Kelola Akun
  </button>

  <button onclick="logout()">Logout</button>
</div>

<div class="content">
  <h1>Dashboard Admin</h1>

  <!-- STRUKTUR PENGURUS -->
  <div class="card">
    <h2>Struktur Pengurus</h2>
    <input type="text" id="namaPengurus" placeholder="Nama Pengurus">
    <select id="jabatan">
     <option>Ketua</option>
     <option>Sekertaris</option>
     <option>Bendahara</option>
     <option>Korektor Pusaka</option>
    </select>
    <button class="tambah" onclick="tambahPengurus()">Tambah</button>
    <ul id="listPengurus"></ul>
  </div>

  <!-- DAFTAR ANGGOTA -->
  <div class="card">
    <h2>Daftar Anggota</h2>

    <table>
      <thead>
        <tr>
          <th>No Anggota</th>
          <th>Nama</th>
          <th>Status</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tabelAnggota"></tbody>
    </table>
  </div>

</div>

<script>

//////////////////////////////////////////////////
// CEK LOGIN
//////////////////////////////////////////////////

if(
  localStorage.getItem("isLoggedIn")!=="true" ||
  !localStorage.getItem("username") ||
  !localStorage.getItem("role")
){
  window.location.href="login.html";
}

const username=localStorage.getItem("username");
const role=localStorage.getItem("role");

document.getElementById("userInfo").innerText="User: "+username;
document.getElementById("roleInfo").innerText="Role: "+role;

if(role==="Super Admin"){
  document.getElementById("menuKelola").style.display="block";
}

//////////////////////////////////////////////////
// LOGOUT (FIX - DATA TIDAK TERHAPUS)
//////////////////////////////////////////////////

function logout(){
  localStorage.removeItem("isLoggedIn");
  localStorage.removeItem("username");
  localStorage.removeItem("role");
  window.location.href="login.html";
}

//////////////////////////////////////////////////
// STRUKTUR PENGURUS
//////////////////////////////////////////////////

let pengurus = JSON.parse(localStorage.getItem("pengurus")) || [];

function tampilPengurus(){
  const list=document.getElementById("listPengurus");
  list.innerHTML="";

  if(pengurus.length===0){
    list.innerHTML="<li>Belum ada pengurus</li>";
    return;
  }

  pengurus.forEach((p,i)=>{
    list.innerHTML+=`
      <li>
        ${p.nama} - ${p.jabatan}
        <button class="hapus" onclick="hapusPengurus(${i})">Hapus</button>
      </li>
    `;
  });
}

function tambahPengurus(){
  const nama=document.getElementById("namaPengurus").value.trim();
  const jabatan=document.getElementById("jabatan").value;

  if(nama==="") return alert("Isi nama!");

  pengurus.push({nama,jabatan});
  localStorage.setItem("pengurus",JSON.stringify(pengurus));

  document.getElementById("namaPengurus").value="";
  tampilPengurus();
}

function hapusPengurus(i){
  pengurus.splice(i,1);
  localStorage.setItem("pengurus",JSON.stringify(pengurus));
  tampilPengurus();
}

tampilPengurus();

//////////////////////////////////////////////////
// DAFTAR ANGGOTA
//////////////////////////////////////////////////

let anggota = JSON.parse(localStorage.getItem("anggota"));

if(!anggota){
  anggota = [
    {no:"SKH-0001", nama:"Sugeng Hidayat", status:"Aktif"},
    {no:"SKH-0002", nama:"Muhammad Muslim", status:"Aktif"}
  ];
  localStorage.setItem("anggota",JSON.stringify(anggota));
}

function tampilAnggota(){
  const tabel=document.getElementById("tabelAnggota");
  tabel.innerHTML="";

  anggota.forEach((a,i)=>{
    tabel.innerHTML+=`
      <tr>
        <td>${a.no}</td>
        <td>${a.nama}</td>
        <td>
          <select onchange="ubahStatus(${i}, this.value)">
            <option ${a.status==="Aktif"?"selected":""}>Aktif</option>
            <option ${a.status==="Nonaktif"?"selected":""}>Nonaktif</option>
          </select>
        </td>
        <td>
          <button class="hapus" onclick="hapusAnggota(${i})">Hapus</button>
        </td>
      </tr>
    `;
  });
}

function ubahStatus(i,status){
  anggota[i].status=status;
  localStorage.setItem("anggota",JSON.stringify(anggota));
}

function hapusAnggota(i){
  if(confirm("Yakin ingin menghapus anggota ini?")){
    anggota.splice(i,1);
    localStorage.setItem("anggota",JSON.stringify(anggota));
    tampilAnggota();
  }
}

tampilAnggota();

</script>

</body>
</html>
