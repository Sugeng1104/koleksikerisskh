<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Arsip Sertifikat Nasional SKH</title>

<style>
body{
    font-family:Georgia,serif;
    background:#0f172a;
    color:white;
    padding:40px;
}
.container{
    max-width:900px;
    margin:auto;
    background:#1e293b;
    padding:30px;
    border-radius:14px;
}
h2{
    text-align:center;
    margin-bottom:30px;
}
.card{
    background:#111827;
    padding:15px;
    border-radius:10px;
    margin-bottom:15px;
    display:flex;
    align-items:center;
}
.card img{
    width:120px;
    height:120px;
    object-fit:cover;
    border-radius:10px;
    margin-right:15px;
    border:2px solid gold;
}
.valid{
    background:#065f46;
    padding:15px;
    border-radius:10px;
    margin-bottom:20px;
}
.invalid{
    background:#7f1d1d;
    padding:15px;
    border-radius:10px;
    margin-bottom:20px;
}
small{color:#ccc;}
</style>
</head>
<body>

<div class="container">
<h2>Arsip Sertifikat Nasional SKH</h2>

<div id="verifikasiBox"></div>

<div id="daftar"></div>

</div>

<script>
//////////////////////////////////////////////////
// KONFIGURASI API
//////////////////////////////////////////////////
const API_URL="https://script.google.com/macros/s/AKfycbyxp18VDz5srBz9VrCYL8MqpSTczOHqf179x83nPYg1TlHr2erB1KCLKGrglUBsDptkwA/exec";

//////////////////////////////////////////////////
// AMBIL PARAMETER URL
//////////////////////////////////////////////////
const params=new URLSearchParams(window.location.search);
const verify=params.get("verify");

//////////////////////////////////////////////////
// LOAD DATA
//////////////////////////////////////////////////
fetch(API_URL+"?action=get")
.then(res=>res.json())
.then(data=>{

    const daftar=document.getElementById("daftar");
    const verifikasiBox=document.getElementById("verifikasiBox");

    //////////////////////////////////////////////////
    // MODE VERIFIKASI QR
    //////////////////////////////////////////////////
    if(verify){

        const found=data.find(item=>item.nomor===verify);

        if(found){
            verifikasiBox.innerHTML=`
                <div class="valid">
                    <h3>✔ Sertifikat VALID</h3>
                    <strong>${found.nama}</strong><br>
                    Nomor: ${found.nomor}<br>
                    Pemilik: ${found.pemilik||"-"}<br>
                    Jenis: ${found.jenis||"-"}<br>
                    Periode: ${found.periode||"-"}<br>
                    <small>Terdaftar Resmi di Sistem SKH</small>
                </div>
            `;
        }else{
            verifikasiBox.innerHTML=`
                <div class="invalid">
                    <h3>✖ Sertifikat Tidak Ditemukan</h3>
                    Nomor tidak terdaftar dalam sistem.
                </div>
            `;
        }

        return; // hentikan tampilan daftar jika mode verifikasi
    }

    //////////////////////////////////////////////////
    // MODE ARSIP NORMAL
    //////////////////////////////////////////////////
    data.forEach(item=>{
        daftar.innerHTML+=`
            <div class="card">
                <img src="${item.foto}">
                <div>
                    <strong>${item.nama}</strong><br>
                    Nomor: ${item.nomor}<br>
                    Pemilik: ${item.pemilik||"-"}<br>
                    Jenis: ${item.jenis||"-"}<br>
                    Periode: ${item.periode||"-"}<br>
                    <small>Terdaftar Resmi SKH</small>
                </div>
            </div>
        `;
    });

});
</script>

</body>
</html>
