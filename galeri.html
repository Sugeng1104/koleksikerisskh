<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SKH Museum Nasional Digital</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body{
    margin:0;
    background:#000;
    font-family:Georgia,serif;
    color:white;
    overflow-x:hidden;
}
.container{
    max-width:1400px;
    margin:auto;
    padding:40px;
}
h1{
    text-align:center;
    font-size:38px;
    color:gold;
    text-shadow:0 0 20px gold;
}
.gallery{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:25px;
}
.card{
    background:#111;
    border-radius:15px;
    overflow:hidden;
    transition:0.4s;
    box-shadow:0 0 20px rgba(212,175,55,0.3);
    cursor:pointer;
}
.card:hover{
    transform:scale(1.05);
    box-shadow:0 0 40px gold;
}
.img-wrapper{
    position:relative;
}
.img-wrapper img{
    width:100%;
    height:240px;
    object-fit:cover;
}
.watermark{
    position:absolute;
    bottom:10px;
    right:10px;
    font-size:11px;
    background:rgba(0,0,0,0.6);
    padding:4px 8px;
    border-radius:6px;
    color:gold;
}
.card-body{
    padding:15px;
}
.card-body h3{
    margin:5px 0;
    color:gold;
}
.card-body p{
    font-size:14px;
    color:#ddd;
}

/* MODAL */
.modal{
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.95);
    z-index:2000;
    overflow:auto;
}
.modal-content{
    max-width:1000px;
    margin:60px auto;
    background:#111;
    padding:30px;
    border-radius:15px;
    box-shadow:0 0 40px gold;
}
.modal img{
    width:100%;
    max-height:500px;
    object-fit:contain;
    cursor:zoom-in;
}
.close-btn{
    position:absolute;
    top:20px;
    right:30px;
    font-size:30px;
    color:gold;
    cursor:pointer;
}
.qr-box{
    margin-top:20px;
    background:#000;
    padding:15px;
    display:inline-block;
}
.back-home-btn{
    position:fixed;
    bottom:25px;
    right:25px;
    background:linear-gradient(45deg,#1e3a8a,#2563eb);
    color:white;
    padding:14px 20px;
    border-radius:50px;
    font-weight:bold;
    text-decoration:none;
    box-shadow:0 0 20px rgba(37,99,235,0.7);
    transition:0.3s;
}
.back-home-btn:hover{
    transform:scale(1.08);
}

@media(max-width:900px){
.gallery{grid-template-columns:repeat(2,1fr);}
}
@media(max-width:500px){
.gallery{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<div class="container">
<h1>SKH MUSEUM NASIONAL DIGITAL</h1>
<div class="gallery" id="galleryContainer"></div>
</div>

<a href="index.html" class="back-home-btn">üè† Halaman Depan</a>

<!-- MODAL DETAIL -->
<div id="modal" class="modal">
<span class="close-btn" onclick="closeModal()">‚úñ</span>
<div class="modal-content" id="modalContent"></div>
</div>

<script>

//////////////////////////////////////////////////
// DECRYPT (SINKRON ADMIN)
//////////////////////////////////////////////////
function decrypt(data){
    try{
        return JSON.parse(decodeURIComponent(escape(atob(data))));
    }catch{
        return [];
    }
}

let raw = localStorage.getItem("dataPusaka");
let dataPusaka = raw ? decrypt(raw) : [];

dataPusaka.sort((a,b)=>b.timestamp-a.timestamp);

//////////////////////////////////////////////////
// RENDER GALERI
//////////////////////////////////////////////////
function renderGallery(){
    const container=document.getElementById("galleryContainer");
    container.innerHTML="";

    if(dataPusaka.length===0){
        container.innerHTML="<p style='text-align:center'>Belum ada koleksi.</p>";
        return;
    }

    dataPusaka.forEach(item=>{
        container.innerHTML+=`
        <div class="card" onclick="openDetail('${item.hash}')">
            <div class="img-wrapper">
                <img src="${item.foto}">
                <div class="watermark">SKH ARCHIVE</div>
            </div>
            <div class="card-body">
                <h3>${item.nama}</h3>
                <p>Pemilik: ${item.pemilik||"-"}</p>
                <p>Jenis: ${item.jenis||"-"}</p>
            </div>
        </div>`;
    });
}

//////////////////////////////////////////////////
// MODAL DETAIL + QR
//////////////////////////////////////////////////
function openDetail(hash){

    let item=dataPusaka.find(x=>x.hash===hash);
    if(!item) return;

    const modal=document.getElementById("modal");
    const content=document.getElementById("modalContent");

    content.innerHTML=`
        <h2 style="color:gold">${item.nama}</h2>
        <img src="${item.foto}" onclick="zoomImage(this)">
        <p><strong>Nomor Sertifikat:</strong> ${item.nomor}</p>
        <p><strong>Pemilik:</strong> ${item.pemilik||"-"}</p>
        <p><strong>Jenis:</strong> ${item.jenis||"-"}</p>
        <p><strong>Periode:</strong> ${item.periode||"-"}</p>
        <p>${item.deskripsi||""}</p>

        <div class="qr-box">
            <div id="qrcode"></div>
        </div>
    `;

    modal.style.display="block";

    new QRCode(document.getElementById("qrcode"),{
        text:"verifikasi.html?id="+item.hash,
        width:150,
        height:150
    });
}

function closeModal(){
    document.getElementById("modal").style.display="none";
}

//////////////////////////////////////////////////
// ZOOM FOTO
//////////////////////////////////////////////////
function zoomImage(img){
    if(img.style.transform==="scale(1.5)"){
        img.style.transform="scale(1)";
        img.style.cursor="zoom-in";
    }else{
        img.style.transform="scale(1.5)";
        img.style.cursor="zoom-out";
    }
}

renderGallery();

</script>

</body>
</html>
