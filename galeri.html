<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SKH Museum Nasional Digital</title>

<!-- QR & HASH ENGINE -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

<style>
body{
    margin:0;
    background:#000;
    font-family:Georgia,serif;
    color:white;
    overflow-x:hidden;
}

.container{
    max-width:1400px;
    margin:auto;
    padding:40px;
}

h1{
    text-align:center;
    font-size:38px;
    color:gold;
    text-shadow:0 0 20px gold;
}

.gallery{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:25px;
}

.card{
    background:#111;
    border-radius:15px;
    overflow:hidden;
    transition:0.4s;
    box-shadow:0 0 20px rgba(212,175,55,0.3);
    cursor:pointer;
    position:relative;
}

.card:hover{
    transform:scale(1.05);
    box-shadow:0 0 40px gold;
}

.img-wrapper{
    position:relative;
}

.img-wrapper img{
    width:100%;
    height:240px;
    object-fit:cover;
}

.watermark{
    position:absolute;
    bottom:10px;
    right:10px;
    font-size:11px;
    background:rgba(0,0,0,0.6);
    padding:4px 8px;
    border-radius:6px;
    color:gold;
}

.card-body{
    padding:15px;
}

.card-body h3{
    margin:5px 0;
    color:gold;
}

.card-body p{
    font-size:14px;
    color:#ddd;
}

.qr-box{
    position:absolute;
    top:10px;
    right:10px;
    background:#000;
    padding:5px;
    border-radius:8px;
}

.verify{
    font-size:11px;
    color:#00ff88;
    margin-top:5px;
}

.top-buttons{
    position:fixed;
    top:20px;
    right:20px;
    display:flex;
    gap:10px;
    z-index:1000;
}

.top-buttons button{
    padding:8px 14px;
    background:gold;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}

.back-home-btn{
    position:fixed;
    bottom:25px;
    right:25px;
    background:linear-gradient(45deg,#1e3a8a,#2563eb);
    color:white;
    padding:14px 20px;
    border-radius:50px;
    font-weight:bold;
    text-decoration:none;
    box-shadow:0 0 20px rgba(37,99,235,0.7);
    transition:0.3s;
    z-index:1000;
}

.back-home-btn:hover{
    transform:scale(1.08);
    box-shadow:0 0 35px rgba(37,99,235,1);
}

@media(max-width:900px){
.gallery{grid-template-columns:repeat(2,1fr);}
}
@media(max-width:500px){
.gallery{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<div class="top-buttons">
    <button onclick="window.print()">Cetak Katalog</button>
</div>

<div class="container">
<h1>SKH MUSEUM NASIONAL DIGITAL</h1>
<div class="gallery" id="galleryContainer"></div>
</div>

<a href="index.html" class="back-home-btn">üè† Halaman Depan</a>

<script>

//////////////////////////////////////////////////
// SECRET KEY (SERAGAM SEMUA HALAMAN)
//////////////////////////////////////////////////
const SECRET_KEY = "SKH_MUSEUM_NASIONAL_2026";

//////////////////////////////////////////////////
// HASH GENERATOR (Blockchain Style)
//////////////////////////////////////////////////
function generateEncryptedData(item){
    const raw = item.hash + "|" + item.nama + "|" + (item.jenis||"") + "|" + SECRET_KEY;
    return CryptoJS.SHA256(raw).toString();
}

//////////////////////////////////////////////////
// DECRYPT DATA
//////////////////////////////////////////////////
function decrypt(data){
    try{
        return JSON.parse(decodeURIComponent(escape(atob(data))));
    }catch{
        return [];
    }
}

let raw = localStorage.getItem("dataPusaka");
let dataPusaka = raw ? decrypt(raw) : [];

dataPusaka.sort((a,b)=>b.timestamp-a.timestamp);

//////////////////////////////////////////////////
// RENDER GALERI
//////////////////////////////////////////////////
function renderGallery(){

    const container=document.getElementById("galleryContainer");
    container.innerHTML="";

    if(dataPusaka.length===0){
        container.innerHTML="<p style='text-align:center'>Belum ada koleksi.</p>";
        return;
    }

    dataPusaka.forEach((item,index)=>{

        const hashQR = generateEncryptedData(item);

        container.innerHTML+=`
        <div class="card" onclick="openDetail('${item.hash}')">
            <div class="img-wrapper">
                <img src="${item.foto}">
                <div class="watermark">SKH ARCHIVE</div>
                <div class="qr-box">
                    <div id="qr${index}"></div>
                    <div class="verify">Verified</div>
                </div>
            </div>
            <div class="card-body">
                <h3>${item.nama}</h3>
                <p>Pemilik: ${item.pemilik||"-"}</p>
                <p>Jenis: ${item.jenis||"-"}</p>
            </div>
        </div>
        `;

        setTimeout(()=>{
            new QRCode(document.getElementById("qr"+index),{
                text: hashQR,
                width:70,
                height:70,
                correctLevel: QRCode.CorrectLevel.H
            });
        },100);

    });
}

//////////////////////////////////////////////////
// OPEN DETAIL
//////////////////////////////////////////////////
function openDetail(hash){
    window.location.href="detail.html?id="+hash;
}

renderGallery();

</script>

</body>
</html>
