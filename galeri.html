<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galeri Ultimate SKH</title>

<style>
<a href="index.html" class="back-home-btn">
    â¬… Kembali ke Halaman Depan
</a>
.back-home-btn{
    position:fixed;
    bottom:25px;
    right:25px;
    background:linear-gradient(45deg,#1e3a8a,#2563eb);
    color:white;
    padding:14px 20px;
    border-radius:50px;
    font-weight:bold;
    text-decoration:none;
    box-shadow:0 0 20px rgba(37,99,235,0.7);
    transition:0.3s;
    z-index:1000;
    animation:float 3s ease-in-out infinite;
}

.back-home-btn:hover{
    transform:scale(1.08);
    box-shadow:0 0 35px rgba(37,99,235,1);
}

@keyframes float{
    0%,100%{transform:translateY(0);}
    50%{transform:translateY(-8px);}
}
body{
    margin:0;
    background:radial-gradient(circle at center,#111,#000);
    font-family:Georgia,serif;
    color:white;
    overflow-x:hidden;
}

canvas{
    position:fixed;
    top:0;
    left:0;
    z-index:-1;
}

.container{
    max-width:1400px;
    margin:auto;
    padding:40px;
}

h1{
    text-align:center;
    font-size:36px;
    color:gold;
    text-shadow:0 0 20px gold;
}

.stats{
    display:flex;
    justify-content:center;
    gap:40px;
    margin:30px 0;
}

.stat-box{
    background:#111;
    padding:20px;
    border-radius:12px;
    box-shadow:0 0 20px rgba(212,175,55,0.5);
    text-align:center;
}

.gallery{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:25px;
}

.card{
    background:#111;
    border-radius:15px;
    overflow:hidden;
    transition:0.4s;
    box-shadow:0 0 20px rgba(212,175,55,0.3);
}

.card:hover{
    transform:scale(1.05);
    box-shadow:0 0 40px gold;
}

.img-wrapper{
    position:relative;
}

.img-wrapper img{
    width:100%;
    height:240px;
    object-fit:cover;
}

.watermark{
    position:absolute;
    bottom:10px;
    right:10px;
    font-size:11px;
    background:rgba(0,0,0,0.6);
    padding:4px 8px;
    border-radius:6px;
    color:gold;
}

.card-body{
    padding:15px;
}

.card-body h3{
    margin:5px 0;
    color:gold;
}

.card-body p{
    font-size:14px;
    color:#ddd;
}

.card-body button{
    margin-top:10px;
    padding:6px 10px;
    background:gold;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}

.lightbox{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.95);
    justify-content:center;
    align-items:center;
    flex-direction:column;
    z-index:999;
}

.lightbox img{
    max-width:80%;
    max-height:70%;
    border-radius:10px;
    box-shadow:0 0 40px gold;
}

.lightbox-controls{
    margin-top:20px;
}

.lightbox-controls button{
    padding:10px 15px;
    margin:0 10px;
    border:none;
    border-radius:6px;
    background:gold;
    cursor:pointer;
}

@media(max-width:900px){
.gallery{grid-template-columns:repeat(2,1fr);}
}
@media(max-width:500px){
.gallery{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<canvas id="bg"></canvas>

<div class="container">

<h1>IMPERIAL GALLERY SKH</h1>

<div class="stats">
    <div class="stat-box">
        <h2 id="totalStat">0</h2>
        <p>Total Koleksi</p>
    </div>
    <div class="stat-box">
        <h2 id="jenisStat">-</h2>
        <p>Jenis Terbanyak</p>
    </div>
    <div class="stat-box">
        <h2 id="newStat">-</h2>
        <p>Koleksi Terbaru</p>
    </div>
</div>

<div class="gallery" id="galleryContainer"></div>

</div>

<div class="lightbox" id="lightbox">
    <img id="lightboxImg">
    <div class="lightbox-controls">
        <button onclick="prevImage()">Prev</button>
        <button onclick="nextImage()">Next</button>
        <button onclick="closeLightbox()">Close</button>
    </div>
</div>

<script>

function decrypt(data){
    try{
        return JSON.parse(decodeURIComponent(escape(atob(data))));
    }catch{
        return [];
    }
}

let raw = localStorage.getItem("dataPusaka");
let dataPusaka = raw ? decrypt(raw) : [];

let currentIndex=0;

//////////////////////////////////////////////////
// STATS
//////////////////////////////////////////////////

function renderStats(){
    document.getElementById("totalStat").innerText=dataPusaka.length;

    let jenisCount={};
    dataPusaka.forEach(d=>{
        jenisCount[d.jenis]=(jenisCount[d.jenis]||0)+1;
    });

    let terbanyak=Object.keys(jenisCount).reduce((a,b)=>jenisCount[a]>jenisCount[b]?a:b,"-");
    document.getElementById("jenisStat").innerText=terbanyak||"-";

    let terbaru=dataPusaka.sort((a,b)=>b.timestamp-a.timestamp)[0];
    document.getElementById("newStat").innerText=terbaru?terbaru.nama:"-";
}

//////////////////////////////////////////////////
// RENDER GALERI
//////////////////////////////////////////////////

function renderGallery(){
    const container=document.getElementById("galleryContainer");
    container.innerHTML="";

    dataPusaka.forEach((item,index)=>{
        container.innerHTML+=`
        <div class="card">
            <div class="img-wrapper">
                <img src="${item.foto}" onclick="openLightbox(${index})">
                <div class="watermark">${item.nama}</div>
            </div>
            <div class="card-body">
                <h3>${item.nama}</h3>
                <p>Pemilik: ${item.pemilik||"-"}</p>
                <p>Jenis: ${item.jenis||"-"}</p>
                <button onclick="downloadCertificate('${item.nama}')">Download Sertifikat</button>
            </div>
        </div>`;
    });
}

//////////////////////////////////////////////////
// LIGHTBOX
//////////////////////////////////////////////////

function openLightbox(index){
    currentIndex=index;
    document.getElementById("lightboxImg").src=dataPusaka[index].foto;
    document.getElementById("lightbox").style.display="flex";
}

function closeLightbox(){
    document.getElementById("lightbox").style.display="none";
}

function nextImage(){
    currentIndex=(currentIndex+1)%dataPusaka.length;
    openLightbox(currentIndex);
}

function prevImage(){
    currentIndex=(currentIndex-1+dataPusaka.length)%dataPusaka.length;
    openLightbox(currentIndex);
}

//////////////////////////////////////////////////
// CERTIFICATE
//////////////////////////////////////////////////

function downloadCertificate(nama){
    alert("Sertifikat untuk "+nama+" sedang diproses...");
}

//////////////////////////////////////////////////
// PARTICLE BACKGROUND
//////////////////////////////////////////////////

const canvas=document.getElementById("bg");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let particles=[];
for(let i=0;i<100;i++){
particles.push({
x:Math.random()*canvas.width,
y:Math.random()*canvas.height,
r:Math.random()*2,
d:Math.random()*1
});
}

function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);
ctx.fillStyle="gold";
particles.forEach(p=>{
ctx.beginPath();
ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
ctx.fill();
p.y+=p.d;
if(p.y>canvas.height)p.y=0;
});
requestAnimationFrame(draw);
}
draw();

//////////////////////////////////////////////////

renderStats();
renderGallery();

</script>

</body>
</html>
