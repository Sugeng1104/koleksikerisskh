<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verifikasi Koleksi SKH</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
body{
    margin:0;
    background:#000;
    font-family:Georgia,serif;
    color:white;
    text-align:center;
    padding:40px;
}

.card{
    background:#111;
    max-width:600px;
    margin:auto;
    padding:30px;
    border-radius:15px;
    box-shadow:0 0 30px rgba(212,175,55,0.5);
}

.valid{
    color:#00ff88;
    font-size:22px;
}

.invalid{
    color:red;
    font-size:22px;
}

h1{
    color:gold;
}
</style>
</head>
<body>

<div class="card">
    <h1>VERIFIKASI KOLEKSI SKH</h1>
    <div id="result"></div>
</div>

<script>

const SECRET_KEY = "SKH_MUSEUM_NASIONAL_2026";

function generateEncryptedData(item){
    const raw = item.hash + "|" + item.nama + "|" + (item.jenis||"") + "|" + SECRET_KEY;
    return CryptoJS.SHA256(raw).toString();
}

function decrypt(data){
    try{
        return JSON.parse(decodeURIComponent(escape(atob(data))));
    }catch{
        return [];
    }
}

const params = new URLSearchParams(window.location.search);
const id = params.get("id");

let raw = localStorage.getItem("dataPusaka");
let dataPusaka = raw ? decrypt(raw) : [];

let found = dataPusaka.find(item => item.hash === id);

const resultDiv = document.getElementById("result");

if(found){

    const recalculated = generateEncryptedData(found);

    resultDiv.innerHTML = `
        <p class="valid">✔ KOLEKSI VALID & TERVERIFIKASI</p>
        <p><strong>Nama:</strong> ${found.nama}</p>
        <p><strong>Pemilik:</strong> ${found.pemilik||"-"}</p>
        <p><strong>Jenis:</strong> ${found.jenis||"-"}</p>
        <p><strong>Hash Blockchain:</strong><br>${recalculated}</p>
    `;

}else{

    resultDiv.innerHTML = `
        <p class="invalid">✖ DATA TIDAK VALID / TIDAK DITEMUKAN</p>
    `;
}

</script>

</body>
</html>
